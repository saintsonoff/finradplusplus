apiVersion: 1

contactPoints:
  - orgId: 1
    name: telegram-notifications
    receivers:
      - uid: telegram-receiver
        type: telegram
        settings:
          bottoken: 8277318136:AAE7qhdLBgxjqe4bgeefBwV8Hz-5_sexVOs
          chatid: "-4806682263"
          message: |
            {{ range .Alerts }}
            üö® ALERT: {{ .Labels.alertname }}
            
            üìä Status: {{ .Status }}
            ‚ö†Ô∏è Severity: {{ .Labels.severity }}
            
            üìù Summary: {{ .Annotations.summary }}
            
            üìÑ Description: {{ .Annotations.description }}
            
            üïê Time: {{ .StartsAt.Format "2006-01-02 15:04:05" }}
            {{ end }}
        disableResolveMessage: true

  - orgId: 1
    name: email-notifications
    receivers:
      - uid: email-receiver
        type: email
        settings:
          addresses: u6953671007@gmail.com
          singleEmail: true
        disableResolveMessage: false

  - orgId: 1
    name: webhook-notifications
    receivers:
      - uid: webhook-receiver
        type: webhook
        settings:
          url: http://webhook-service:8888/webhook/alerts
          httpMethod: POST
          maxAlerts: 10
        disableResolveMessage: true

policies:
  - orgId: 1
    receiver: telegram-notifications
    group_by:
      - alertname
    group_wait: 5s
    group_interval: 30s
    repeat_interval: 5m
    routes:
      - receiver: telegram-notifications
        matchers:
          - severity =~ critical|warning
        group_wait: 5s
        group_interval: 30s
        repeat_interval: 5m
        continue: true

      - receiver: webhook-notifications
        matchers:
          - severity =~ critical|warning
        group_wait: 5s
        group_interval: 30s
        repeat_interval: 5m
        continue: false
